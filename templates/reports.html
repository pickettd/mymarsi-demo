<ion-view title="Admin" id="admin">
  <ion-content padding="true" class="has-header">
    <div class="list">
      <div class="item">
        <div class="list card no-margin">
          <div class="item item-divider"
               ng-click="reports.showNewUnit = !reports.showNewUnit">
            <button>
              <i class="icon"
                 ng-class="reports.showNewUnit ? 'ion-minus' : 'ion-plus'">
              </i>
            </button>
            <span>Create new unit</span>
          </div>
          <div ng-if="reports.showNewUnit"
               class="item item-body">
            <form ng-submit="reports.createUnit()">
              <div class="list">
                <label class="item item-input">
                  <input type="text" placeholder="New unit's name and number (e.g. Maui Sands 5A)"
                         ng-model="reports.newUnit.name">
                </label>
                <label class="item item-input item-select">
                  <div class="input-label">
                    Bedrooms/Bathrooms
                  </div>
                  <select ng-options="tmpl as tmpl.displayName for tmpl in reports.currentInspectionTemplateOptions track by tmpl._id"
                          ng-model="reports.newUnit.unitTemplate">
                  </select>
                </label>
              </div>
              <div class="padding">
                <button type="submit" class="button button-block button-positive">Create</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="item">
        <div class="list">
          <label class="item item-input item-select">
            <div class="input-label">
              Unit/Property
            </div>
            <select ng-options="unit as unit.name for unit in reports.allUnits.data track by unit._id"
                    ng-model="reports.selectedUnit"
                    ng-change="reports.getInspectionStubs(reports.selectedUnit._id)">
            </select>
          </label>
        </div>
      </div>
      <div ng-if="reports.selectedUnit">
        <div class="item">
          <div class="list card no-margin">
            <div class="item item-divider"
                 ng-click="reports.showNewInspection = !reports.showNewInspection">
              <button>
                <i class="icon"
                   ng-class="reports.showNewInspection ? 'ion-minus' : 'ion-plus'">
                </i>
              </button>
              <span>Create new inspection</span>
            </div>
            <div ng-if="reports.showNewInspection"
                 class="item item-body">
              <form ng-submit="reports.createInspection()">
                <div class="list">
                  <label class="item item-input">
                    <input type="text" placeholder="New inspection name (e.g. Oct 2016)"
                           ng-model="reports.newInspectionName">
                  </label>
                </div>
                <div class="padding">
                  <button type="submit" class="button button-block button-positive">Create</button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="item">
          <div ng-if="reports.inspectionStubs"
               class="list">
            <label class="item item-input item-select">
              <div class="input-label">
                Inspection
              </div>
              <select ng-options="inspection as inspection.name for inspection in reports.inspectionStubs track by inspection._id"
                      ng-model="reports.selectedInspection"
                      ng-change="reports.getVisitStubs(reports.selectedInspection._id)">
              </select>
            </label>
          </div>
        </div>
      </div>
      <div ng-if="reports.selectedInspection">
        <a ng-click="reports.getReportInspection(reports.selectedInspection._id)"
           class="button button-balanced button-block">View all inspection data</a>
      </div>
      <!--<div class="item item-divider"
           ng-if="reports.selectedInspection && !reports.fullReportReady">
        ...or view data per visit:
      </div>
      <div ng-if="reports.selectedInspection && !reports.fullReportReady"
           class="item">
        <div ng-if="reports.visitStubs && !reports.fullReportReady"
             class="list">
          <label class="item item-input item-select">
            <div class="input-label">
              Visit
            </div>
            <select ng-options="visit as visit.name for visit in reports.visitStubs track by visit._id"
                    ng-model="reports.selectedVisit"
                    ng-change="reports.getVisitData(reports.selectedVisit._id)">
            </select>
          </label>
        </div>
      </div>
      <div ng-if="reports.selectedVisit && reports.visitData.ready && !reports.fullReportReady"
           class="item">
        <pre>
        {{::reports.visitData.data}}
        </pre>
      </div>-->
      <!-- Note this will only show up if the report is selected and ready -->
      <div ng-include="'templates/detailedReports/inspectionReportV1.html'"></div>
    </div>
  </ion-content>
</ion-view>
