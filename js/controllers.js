"use strict";angular.module("app.controllers",[]).controller("projectsCtrl",["$scope",function(e){}]).controller("entryHallwayCtrl",["$scope","$ionicModal","$pouchDB","$log","DemoDataFactory","$sce","$stateParams",function(e,a,l,n,t,o,r){e.entryHallway={},e.entryHallway.newComments={},e.entryHallway.newImages={},e.entryHallway.newVideos={},e.entryHallway.modalSection="",e.entryHallway.displayTitle="",e.entryHallway.videoError=function(e){n.error(e)},e.entryHallway.videoConfig={sources:[{src:o.trustAsResourceUrl("img/marsi_test_vid1.mp4"),type:"video/mp4"}],tracks:[],theme:"lib/videogular-themes-default/videogular.css"},l.setDatabase("mymarsi-demo-localonly"),l.get({ok:!0,id:r.propertyID}).then(function(a){n.info("Success getting sections from local db"),e.entryHallway.selectedPropertyName=a.name,e.entryHallway.displayTitle=a.name+" - "+a.data[r.inspectionID].name,e.entryHallway.sections=a.data[r.inspectionID].data.entryHallway.data})["catch"](function(a){if(404===a.status){n.info("Section data not found in local database; creating");var o=t.properties[r.propertyID],y=o.name+" - "+o.data[r.inspectionID].name;e.entryHallway.displayTitle=y,e.entryHallway.sections=o.data[r.inspectionID].data.entryHallway.data,l.save(o)["catch"](function(e){n.error(e)})}else n.error(a)})["finally"](function(){e.$watch("entryHallway.sections",function(e,a){if(e!==a){var o=t.properties[r.propertyID];o.data[r.inspectionID].data.entryHallway.data=e,l.save(o).then(function(){n.info("Success saving change to db")})["catch"](function(e){409===e.status?l.retryUntilWritten(o):n.error(e)})}},!0)});var y=function(a){e.entryHallway.modalSection=a},i=function(){var a=0;return angular.forEach(e.entryHallway.sections[e.entryHallway.modalSection].videos,function(e){a++}),a};e.entryHallway.videoFileNameChanged=function(a){if(e.entryHallway.videoFilesItemHandle=a,1===a.files.length&&0===a.files[0].type.indexOf("video/")){var l=new FileReader;l.onload=function(a){var l=e.entryHallway.videoFilesItemHandle.files[0].name,n=e.entryHallway.videoFilesItemHandle.files[0].type;e.entryHallway.newVideos||(e.entryHallway.newVideos={}),e.entryHallway.sections[e.entryHallway.modalSection].videos||(e.entryHallway.sections[e.entryHallway.modalSection].videos={});var t={src:a.target.result,name:l,type:n};e.entryHallway.newVideos[e.entryHallway.modalSection].array=[t],e.$apply()},l.readAsDataURL(a.files[0])}},e.entryHallway.addNewVideo=function(){var a=angular.copy(e.entryHallway.newVideos[e.entryHallway.modalSection]);e.entryHallway.newVideos||(e.entryHallway.newVideos={}),e.entryHallway.sections[e.entryHallway.modalSection].videos||(e.entryHallway.sections[e.entryHallway.modalSection].videos={}),a._id=i()+1,e.entryHallway.sections[e.entryHallway.modalSection].videos[a._id]=a,e.entryHallway.newVideos[e.entryHallway.modalSection]={},e.entryHallway.videoFilesItemHandle.value=""},e.entryHallway.deleteVideo=function(a){delete e.entryHallway.sections[e.entryHallway.modalSection].videos[a]};var s=function(){var a=0;return angular.forEach(e.entryHallway.sections[e.entryHallway.modalSection].images,function(e){a++}),a};e.entryHallway.fileNameChanged=function(a){if(e.entryHallway.filesItemHandle=a,1===a.files.length&&0===a.files[0].type.indexOf("image/")){var l=new FileReader;l.onload=function(a){var l=e.entryHallway.filesItemHandle.files[0].name;e.entryHallway.newImages||(e.entryHallway.newImages={}),e.entryHallway.sections[e.entryHallway.modalSection].images||(e.entryHallway.sections[e.entryHallway.modalSection].images={}),e.entryHallway.newImages[e.entryHallway.modalSection].src=a.target.result,e.entryHallway.newImages[e.entryHallway.modalSection].name=l,e.$apply()},l.readAsDataURL(a.files[0])}},e.entryHallway.addNewImage=function(){var a=angular.copy(e.entryHallway.newImages[e.entryHallway.modalSection]);e.entryHallway.newImages||(e.entryHallway.newImages={}),e.entryHallway.sections[e.entryHallway.modalSection].images||(e.entryHallway.sections[e.entryHallway.modalSection].images={}),a._id=s()+1,e.entryHallway.sections[e.entryHallway.modalSection].images[a._id]=a,e.entryHallway.newImages[e.entryHallway.modalSection]={},e.entryHallway.filesItemHandle.value=""},e.entryHallway.deleteImage=function(a){delete e.entryHallway.sections[e.entryHallway.modalSection].images[a]};var c=function(){var a=0;return angular.forEach(e.entryHallway.sections[e.entryHallway.modalSection].comments,function(e){a++}),a};e.entryHallway.deleteComment=function(a){delete e.entryHallway.sections[e.entryHallway.modalSection].comments[a]},e.entryHallway.createComment=function(){var a=angular.copy(e.entryHallway.newComments[e.entryHallway.modalSection]);e.entryHallway.comments||(e.entryHallway.comments={}),e.entryHallway.sections[e.entryHallway.modalSection].comments||(e.entryHallway.sections[e.entryHallway.modalSection].comments={}),a._id=c()+1,e.entryHallway.sections[e.entryHallway.modalSection].comments[a._id]=a,e.entryHallway.newComments[e.entryHallway.modalSection]={}},a.fromTemplateUrl("templates/modals/manageComments.html",{scope:e,animation:"slide-in-up",focusFirstInput:!0}).then(function(a){e.entryHallway.commentsModal=a}),e.entryHallway.openCommentsModal=function(a){y(a),e.entryHallway.newComments[e.entryHallway.modalSection]||(e.entryHallway.newComments[e.entryHallway.modalSection]={}),e.entryHallway.commentsModal.show()},e.entryHallway.closeCommentsModal=function(){e.entryHallway.commentsModal.hide()},e.$on("$destroy",function(){e.entryHallway.commentsModal.remove()}),a.fromTemplateUrl("templates/modals/manageVideos.html",{scope:e,animation:"slide-in-up"}).then(function(a){e.entryHallway.videosModal=a}),e.entryHallway.openVideosModal=function(a){y(a),e.entryHallway.newVideos[e.entryHallway.modalSection]||(e.entryHallway.newVideos[e.entryHallway.modalSection]={}),e.entryHallway.sections[e.entryHallway.modalSection].showDelete=!1,e.entryHallway.videosModal.show()},e.entryHallway.closeVideosModal=function(){e.entryHallway.videosModal.hide()},e.$on("$destroy",function(){e.entryHallway.videosModal.remove()}),a.fromTemplateUrl("templates/modals/manageImages.html",{scope:e,animation:"slide-in-up"}).then(function(a){e.entryHallway.imagesModal=a}),e.entryHallway.openImagesModal=function(a){y(a),e.entryHallway.newImages[e.entryHallway.modalSection]||(e.entryHallway.newImages[e.entryHallway.modalSection]={}),e.entryHallway.imagesModal.show()},e.entryHallway.closeImagesModal=function(){e.entryHallway.imagesModal.hide()},e.$on("$destroy",function(){e.entryHallway.imagesModal.remove()})}]).controller("kitchenCtrl",["$scope",function(e){}]).controller("livingRoomCtrl",["$scope",function(e){}]).controller("diningRoomCtrl",["$scope",function(e){}]).controller("masterBathroomCtrl",["$scope",function(e){}]).controller("bathroom2Ctrl",["$scope",function(e){}]).controller("masterBedroomCtrl",["$scope",function(e){}]).controller("bedroom2Ctrl",["$scope",function(e){}]).controller("maintenanceCtrl",["$scope",function(e){}]).controller("factsCtrl",["$scope",function(e){}]).controller("homeCtrl",["$scope","DemoDataFactory","$pouchDB","$log",function(e,a,l,n){e.home={},e.home.properties=a.properties}]).controller("adminCtrl",["$scope",function(e){}]).controller("lanaiCtrl",["$scope",function(e){}]);